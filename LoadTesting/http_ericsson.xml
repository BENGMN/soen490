<?xml version="1.0"?>
<!DOCTYPE tsung SYSTEM "/usr/share/tsung/tsung-1.0.dtd">
<tsung loglevel="notice" version="1.0">
  <clients><client host="localhost" use_controller_vm="true"/></clients>
  <servers><server host="myserver" port="80" type="tcp"></server></servers>
  <monitoring><monitor host="myserver" type="snmp"></monitor></monitoring>
  
  <load>
   <arrivalphase phase="1" duration="10" unit="minute">
     <users interarrival="2" unit="second"></users>
   </arrivalphase>
  </load>

  <options>
   <option type="ts_http" name="user_agent">
    <user_agent probability="100">Ericsson Http Client/1.0 (X11; U; Linux i686; en-US; rv:1.0.0) Ericsson/20120127 Ericsson/1.0.0</user_agent>
   </option>
  </options>

  <!-- start a session for a http user. the probability is the
  frequency of this type os session. The sum of all session's
  probabilities must be 100 -->

 <sessions>
  <session name="getMessages" probability="90" type="ts_http">
    <setdynvars sourcetype="random_number" start="-180" end="180">
        <var name="longitude" />
    </setdynvars>
    <setdynvars sourcetype="random_number" start="-90" end="90">
        <var name="latitude"/>
    </setdynvars>
    <setdynvars sourcetype="file" fileid="userdb" delimiter=";" order="random">
        <var name="email"/>	
    </setdynvars>
    <request subst="true"> <http url="/frontController?command=GetMessages&amp;longitude=%%_longitude%%&amp;latitude=%%_latitude%%&amp;email=%%_email%%" method="GET" version="1.1"></http> </request>
    <thinktime min="20" max="100" random="true"></thinktime>
  </session>
  <session name="putMessage" probability="10" type="ts_http">
    <setdynvars sourcetype="random_number" start="-180" end="180">
        <var name="longitude" />
    </setdynvars>
    <setdynvars sourcetype="random_number" start="-90" end="90">
        <var name="latitude"/>
    </setdynvars>
    <setdynvars sourcetype="file" fileid="userdb" delimiter=";" order="random">
        <var name="email"/>	
    </setdynvars>
    <setdynvars sourcetype="file" fileid="filedb" delimiter=";" order="random">
        <var name="bin"/>
    </setdynvars>
    <request subst="true"> <http url="/frontController" method="POST" version="1.1" contents="command=PutMessage&amp;longitude=%%_longitude%%&amp;latitude=%%_latitude%%&amp;email=%%_email%%;bin=%%_bin%%"></http> </request>
    <thinktime min="20" max="100" random="true"></thinktime>
  </session>
 </sessions>
</tsung>
